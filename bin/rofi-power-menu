#!/bin/bash

options=("Lock" "Logout" "Shutdown" "Reboot" "Sleep")

icons=("" "󰗽" "" "" "󰤄")

# Combine options with icons
combined_options=()
for i in "${!options[@]}"; do
    combined_options+=("${icons[$i]}")
done

# Use Rofi to display the menu and get user selection
selected=$(printf '%s\n' "${combined_options[@]}" | rofi -dmenu -i -theme ~/.config/rofi/power-menu-theme.rasi)

# Exit if nothing selected
if [ -z "$selected" ]; then
    exit 0
fi

# Execute the selected option
case $selected in
    "")
        if command -v hyprlock &> /dev/null; then
            hyprlock
        else
            # Fallback to loginctl if available
            loginctl lock-session 2>/dev/null || notify-send "Error" "No lock screen program found"
        fi
        ;;
    "󰗽")  # Logout
        # Kill Hyprland session
        hyprctl dispatch exit
        ;;
    "")
        systemctl poweroff
        ;;
    "")
        systemctl reboot
        ;;
    "󰤄")  # Sleep
        systemctl suspend
        ;;
    *)
        exit 0
        ;;
esac
